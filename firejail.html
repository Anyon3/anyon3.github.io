<!DOCTYPE html>
<html lang="en">
<head>
<!-- Stop wasting your time seriously -->
<meta charset="UTF-8">
<title>Firejail - Jail unwanted access</title>
<meta name="description" content="Security Linux by sandbox with Firejail.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="css/styles.css" rel="stylesheet">
</head>
<body>
	<ul id=menu>
	<li class=termbl>TTB</li>
	<li><a href="firejail.html" title="Firejail">Firejail</a>
	<li class=iptables>Iptables</li>
	<li class=suricata>Suricata</li>
	<li class=grub>Grub</li>
	<li class=dnscrypt>DNScrypt</li>
	<li class=firefox>Firefox</li>
	<li class=grsecurity>Grsecurity</li>
	</ul>
<div id=mblock>
<h1>The Sandboxing</h1><br>
<p>Firejail is one of the great tools for Linux providing a security layer for most of your binary <i>(like Firefox, Pidgin, Vlc, Irssi, Shell...)</i> by running them inside a restricted environment, customizable with numerous of options. Firejail is a relatively young project and have already known some vulnerability trought is development. Despite this, the development is very actif and add on each update, bug/fix and more feature. It is one of security tool of Linux that should be use for each applications.</p>
		<p>A common usage of Firejail is to use the default predefined profile shipped with Firejail, by running as follow</p>
		<div class=code><span class=comment># Command line in a linux terminal</span><br><span class=command>$ firejail firefox</span></div>
	<p>While it's fine to use Firejail with the predefined profiles or the customized one, it is possbile to define all option through the command
	<p>List of somes Firejail options to harden your binary by restricting their layer access (forbid access to the video, sound, 3d, network...), system environment, system ressources and privilege access</p>
	<div class=list><span> noroot </span> <p>The root access do not exist in the sandbox, only the current user</p>
					<span> noprofile </span> <p>Do not use the default profile defined for the processus. This option should be use for custom firejail command only</p>
					<span> nogroups </span> <p>Do not share any other groups of the user. By default, the processus share all the groups</p>
					<span> nonewprivs </span><p> Any child processes of the running binary will not acquire new privileges by calling a binary with different suid. This protect the running binary to exploit another binary with different permission (higher or not) </p>
					<span> caps.drop=all </span> <p>The capabilities are a kernel feature that divide the root privilege into differents distinct units. By default a root privilege processus can bypass all kernel capabilities while an unprivilege processus trying to access to a capabilities will be subject to a control. This options will drop all capabilities access to the running process.</p>
					<span> seccomp </span> <p>The sandboxing tool of the Linux kernel that reduice to the numbers of system calls of the running process.</p>
					<span> nosound </span> <p>Denied the access of the running process to the sound system (alsa, pulseaudio...) .</p>
					<span> novideo </span> <p>Denied the access of the running process to the video system.</p>
					<span> no3d </span> <p>Denied the access of the running process to the 3D acceleration of the system.</p>
					<span> private </span> <p>Mount a temporary new /root and /home/directory for the sandbox, everything is discarded when the sandbox exit.</p>
					<span> private=~/directory/ </span> <p>Use the target directory as user home, that ensure the process to be isolated from the main home directory of the user </p>
					<span> private-tmp </span> <p>Create a temporary and uniq /tmp/ for the running process. The /tmp/ is removed when the processus exit</p>
					<span> private-dev </span> <p>Create a new directory /dev/ directory for the running process. Only dri, null, full, zero, tty, pts, ptmx, random, snd, urandom, video, log and shm devices are available</p>
					<span> ipc-namespace </span> <p>Enable a new IPC namespace for the processus. Namespace is a feature of isolation and virtualization of the system ressources, it allow to virtualize ressources like the hostname, network access, filesystems... per thread</p>
					<span> machine-id </span> <p>Generate a random machine ID, usefull against the fingerprinting.</p>
					<span> net=none </span> <p>No network connection will be available inside the sandbox. This should be used if you are running a processus that have no need to access to the network connection. Like Vlc or LibreOffice</p>
					<span> dns= </span> <p>Set the dns server to use. You can pass multiples (up to 4) dns= options</p>
					<span> debug </span> <p>Make the running processus printing debug messages</p>
					<span> trace </span> <p>Make the running processus printing trace open, access and connect system calls.</p>
					<span> env= </span> <p>Allow the run a customer environment variable inside the sandbox. --env=LD_PRELOAD=/usr/lib64/torsocks/libtorsocks.so will for example make the network connection trought TOR.</p>
	 </div>
	<p>The full option list of Firejail is available in man page or with the --help parameters. You should consider to read the documentation of Firejail on the man page as often an update is release to acknowledge about the new features.</p>
	<div class=code><span class=comment># Command line in a linux terminal</span><br><span class=command>$ firejail --help</span></div>
	<p>Some example that you can use as template for your own requirement</p>
	<div class=list><span> Firefox </span> <p> $ firejail --private-dev --private-tmp --ipc-namespace --machine-id --noprofile --noroot --caps.drop=all --private=~/firejail/ --seccomp --nonewprivs --debug --trace --nosound --no3d firefox</p>
					<span> Chromium </span> <span class=comment># no-sandbox parameters is needed to allow Firejail sandboxing for chromium.</span> <p> $ firejail --noprofile --noroot --caps.drop=all --private=~/chromejail/ --seccomp --nonewprivs --private-tmp --machine-id --nosound --no3d --ipc-namespace --dns=8.8.8.8 --debug chromium -no-sandbox</p>
					<span> Vlc </span> <p> $ firejail --noprofile --net=none --nonewprivs --private-tmp --seccomp --caps.drop=all vlc</p>
					<span> Irssi </span> <p> $ firejail --noprofile --nonewprivs --noroot --caps.drop=all --nosound --private=~/irssijail/ --private-dev --private-tmp --novideo --machine-id --seccomp --nogroups --env=LD_PRELOAD=/usr/lib64/torsocks/libtorsocks.so irssi</p>
					<span> Gimp </span> <p> $ firejail --noroot --net=none --noprofile --seccomp --nogroups --caps.drop=all --nonewprivs gimp</p>
					<span> Shell jailed </span> <span class=comment># Sandboxing the shell only is useful in many case (ssh for example), the use of --private will discard everything once the sandbox is exit.</span> <p> $ firejail --noprofile --nonewprivs --private --seccomp --noroot --nosound --private-tmp --nogroups --caps.drop=all --machine-id --novideo --env=LD_PRELOAD=/usr/lib64/torsocks/libtorsocks.so</p>
	</div>
			<p>Keep in mind that somes options/features can prevent the application of starting or running correctly (crash...). A simple solution is to remove one by one, the passed option and trying, until success. <i>(Using trace / debug / audit will help you to understand what's wrong)</i>... The more you restrict, the more your sandbox is secure. Prefer the sandboxing method using Firejail rather than the offered on some application. <i>(as Chromium...)</i></p>
			<p><a href="https://firejail.wordpress.com" title="Firejail">Official website of Firejail</a></p>
</div>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/main.js"></script>
</body>
</html>